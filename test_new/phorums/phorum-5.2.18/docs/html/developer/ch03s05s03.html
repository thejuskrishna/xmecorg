<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>3.5.3. pm_before_send</title><link rel="stylesheet" href="../phorum_docbook.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="Phorum Developer Reference Manual"><link rel="up" href="ch03s05.html" title="3.5. Private message system"><link rel="prev" href="ch03s05s02.html" title="3.5.2. pm_delete"><link rel="next" href="ch03s05s04.html" title="3.5.4. before_pm_list"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch03s05s02.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch03s05s04.html">Next</a></td></tr></table><hr></div><div class="section" title="3.5.3. pm_before_send"><div class="titlepage"><div><div><h3 class="title"><a name="hook.pm_before_send"></a>3.5.3. pm_before_send</h3></div></div></div><p>
        (Phorum 5 &gt;= 5.2.15)
      </p><p>

This hook can be used for doing modifications to
PM message data that is stored in the database.
This hook can also be used to apply checks to
the data that is to be posted and to return an
error in case the data should not be posted.
      </p><p>
        <span class="bold"><strong>
          Call time:
        </strong></span>
      </p><p>

Just before the private message is stored in
the database.
      </p><p>
        <span class="bold"><strong>
          Hook input:
        </strong></span>
      </p><p>

An array containing private message data. The
fields in this data are "subject", "message",
"recipients" and "keep".
      </p><p>
        <span class="bold"><strong>
          Hook output:
        </strong></span>
      </p><p>

The message data, possibly modified. A hook can
set the field "error" in the data. In that case,
sending the PM will be halted and the error
message is shown to the user.
      </p><p>
        <span class="bold"><strong>
          Example code:
        </strong></span>
      </p><p>

</p><pre class="programlisting">
function phorum_mod_foo_pm_send_init($message, $action)
{
    if ($message['error'] !== NULL) return $message;

    // Enable "keep copy" option by default.
    if ($action === NULL) {
        $message['keep'] = 1;
    }

    return $message;
}
</pre><p>

      </p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03s05s02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch03s05.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch03s05s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
